libs <- c('data.table', 'dplyr', 'stringr')
sapply(libs, require, character.only = T)
party <- fread('Dropbox/HCLee/data/party.csv')
hwc <- fread('Dropbox/HCLee/data/meetinglog20thHWC.csv', encoding = 'UTF-8')
hwc <- hwc[, colnames(hwc)[summarise_all(hwc, funs(n_distinct)) != 1], with = F]
libs <- c('data.table', 'dplyr', 'stringr')
sapply(libs, require, character.only = T)
party <- fread('Dropbox/HCLee/data/party.csv')
require(data.table)
require(dplyr)
library(readxl)
options(scipen = 1)
WFR <- read_excel(
"./GoogleDrive/Research/HCLee/data/WFR.xlsx",
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
require(data.table)
require(dplyr)
library(readxl)
options(scipen = 1)
WFR <- read_excel(
"./GoogleDrive/Research/HCLee/data/WFR.xlsx",
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
WFR <- read_excel(
"GoogleDrive/Research/HCLee/data/WFR.xlsx",
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
WFR <- read_excel(
"~/GoogleDrive/Research/HCLee/data/WFR.xlsx",
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
# path <- "~/GoogleDrive/Research/HCLee/data/WFR.xlsx"
path <- "../data/WFR.xlsx"
require(data.table)
require(dplyr)
library(readxl)
options(scipen = 1)
# path <- "~/GoogleDrive/Research/HCLee/data/WFR.xlsx"
path <- "../data/WFR.xlsx"
WFR <- read_excel(
path,
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
WFR
setDT(WFR)
WFR[, `예산내역(조원)` := 예산내역/1e6]
WFR[, `log(예산내역(조원)+1)` := log(`예산내역(조원)`+1)]
plot(WFR[, .(`예산내역(조원)`, 발의건수)])
plot(WFR[, .(`log(예산내역(조원)+1)`, 발의건수)])
# plot(WFR[, .(`예산내역(조원)`, 발의건수)])
plot(WFR[, .(`log(예산내역(조원)+1)`, 발의건수)])
require(data.table)
require(dplyr)
library(readxl)
options(scipen = 1)
# path <- "~/GoogleDrive/Research/HCLee/data/WFR.xlsx"
path <- "../data/WFR.xlsx"
WFR <- read_excel(
path,
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
setDT(WFR)
WFR[, `예산내역(조원)` := 예산내역/1e6]
WFR[, `log(예산내역(조원)+1)` := log(`예산내역(조원)`+1)]
# plot(WFR[, .(`예산내역(조원)`, 발의건수)])
plot(WFR[, .(`log(예산내역(조원)+1)`, 발의건수)])
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'poisson', WFR,
control = list('trace' = T))
summary(poiss.fit)
p <- predict(poiss.fit, data.table(
`log(예산내역(조원)+1)` = log(c(0,10,20)+1)), type = 'response')
p[2]-p[1];p[3]-p[2]
cfs <- coef(poiss.fit)
plot(function(x) exp(cfs[1])*(x+1)^cfs[2], 0, 30, add = T, col = 'blue')
summary(poiss.fit)
?family
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'quasipoisson', WFR,
control = list('trace' = T))
summary(poiss.fit)
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'poisson', WFR,
control = list('trace' = T))
summary(poiss.fit)
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'quasipoisson', WFR,
control = list('trace' = T))
summary(poiss.fit)
p <- predict(poiss.fit, data.table(
`log(예산내역(조원)+1)` = log(c(0,10,20)+1)), type = 'response')
p[2]-p[1];p[3]-p[2]
cfs <- coef(poiss.fit)
plot(function(x) exp(cfs[1])*(x+1)^cfs[2], 0, 30, add = T, col = 'blue')
require(data.table)
require(dplyr)
library(readxl)
options(scipen = 1)
# path <- "~/GoogleDrive/Research/HCLee/data/WFR.xlsx"
path <- "../data/WFR.xlsx"
WFR <- read_excel(
path,
sheet = "Sheet1",
col_types = c("text", "numeric", "numeric")
)
setDT(WFR)
WFR[, `예산내역(조원)` := 예산내역/1e6]
WFR[, `log(예산내역(조원)+1)` := log(`예산내역(조원)`+1)]
# plot(WFR[, .(`예산내역(조원)`, 발의건수)])
plot(WFR[, .(`log(예산내역(조원)+1)`, 발의건수)])
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'poisson', WFR,
control = list('trace' = T))
summary(poiss.fit)
View(poiss.fit)
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'quassipoisson', WFR,
control = list('trace' = T))
poiss.fit <- glm(발의건수 ~ `log(예산내역(조원)+1)`, 'quasipoisson', WFR,
control = list('trace' = T))
summary(poiss.fit)
