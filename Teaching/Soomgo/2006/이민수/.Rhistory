1
2
3
1
1
2
3
1
sink()
1
sink('./GoogleDrive/test.txt')
message('message!')
sink()
message('message!')
sink('./GoogleDrive/test.txt')
print('fdsa')
sink()
?car::influenceIndexPlot()
car::influenceIndexPlot(lm(prestige ~ income + education + type, Duncan))
require(car)
car::influenceIndexPlot(lm(prestige ~ income + education + type, Duncan))
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
rownames(raw_data) <- paste(raw_data$year, raw_data$name)
# Corrs -------------------------------------------------------------------
vars <-
c(
'rank',
'prize',
'scoring_avg',
'wins',
'plays',
'top10finish_percentile',
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for.corr <- raw_data[, ..vars]
plot.save.cor(for.corr, file.path(wd, 'results'))
# OLS ---------------------------------------------------------------------
ssnresult <- c('rank',
'prize')
perfs <- c('scoring_avg',
'wins',
'plays',
'top10finish_percentile')
techs <- c(
'name',
'year',
# for naming rows
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for (ass in list('KLPGA', 'LPGA', c('KLPGA', 'LPGA'))) {
if (length(ass) > 1) {
assn <- paste(ass, collapse = '+')
} else{
assn <- ass
}
for.strgz1 <- list()
for (y in ssnresult) {
vars <- c(techs, y)
for.reg <-
raw_data[association %in% ass, ..vars] %>% na.omit %>% as.data.table
# rownames(for.reg) <- paste(for.reg$name, for.reg$year)
for.reg[, `:=`(name = NULL, year = NULL)]
lower <- as.formula(paste(y, '~ 1', sep = ''))
linear <- paste(names(for.reg)[names(for.reg) != y], collapse = '+')
# interactions <- paste(techs[techs != y], collapse = '*')
upper <-
as.formula(paste(y, '~', linear, sep = ''))
lm.base <- lm(lower, data = na.exclude(for.reg))
lm.step <-
MASS::stepAIC(
lm.base,
scope = list(lower = lower, upper = upper),
direction = 'forward',
trace = F
)
steps <- lm.step$anova$Step
for.strgz2 <- list(lm(lower, data = na.exclude(for.reg)))
form <- lower
if (length(steps) > 1) {
for (i in 2:length(steps)) {
cmmnd <- paste('update(form, ~ . ', steps[i], ')', sep = '')
assign('form', eval(parse(text = cmmnd)))
print(form)
for.strgz2[[i]] <- lm(form, data = na.exclude(for.reg))
}
}
diag.save.lm(for.strgz2[[i]], paste(ass, '-on-', y, sep = ''), file.path(wd, 'results'))
for.strgz1[[assn]][[y]] <- for.strgz2
}
stargazer(
for.strgz1,
digits = 2,
title = assn,
df = F,
out = file.path(file.path(wd, 'results'), paste(assn, '-step-on-', y, '.html', sep = ''))
)
}
for.reg
vars <- c(techs, y)
for.reg <-
raw_data[association %in% ass, ..vars] %>% na.omit %>% as.data.table
# rownames(for.reg) <- paste(for.reg$name, for.reg$year)
for.reg[, `:=`(name = NULL, year = NULL)]
for.reg
vars <- c(techs, y)
raw_data
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
rownames(raw_data) <- paste(raw_data$year, raw_data$name)
# Corrs -------------------------------------------------------------------
vars <-
c(
'rank',
'prize',
'scoring_avg',
'wins',
'plays',
'top10finish_percentile',
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for.corr <- raw_data[, ..vars]
plot.save.cor(for.corr, file.path(wd, 'results'))
# OLS ---------------------------------------------------------------------
ssnresult <- c('rank',
'prize')
perfs <- c('scoring_avg',
'wins',
'plays',
'top10finish_percentile')
techs <- c(
'name',
'year',
# for naming rows
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for (ass in list('KLPGA', 'LPGA', c('KLPGA', 'LPGA'))) {
if (length(ass) > 1) {
assn <- paste(ass, collapse = '+')
} else{
assn <- ass
}
for.strgz1 <- list()
for (y in ssnresult) {
vars <- c(techs, y)
for.reg <-
raw_data[association %in% ass, ..vars] %>% na.omit %>% as.data.table
# rownames(for.reg) <- paste(for.reg$name, for.reg$year)
for.reg[, `:=`(name = NULL, year = NULL)]
lower <- as.formula(paste(y, '~ 1', sep = ''))
linear <- paste(names(for.reg)[names(for.reg) != y], collapse = '+')
# interactions <- paste(techs[techs != y], collapse = '*')
upper <-
as.formula(paste(y, '~', linear, sep = ''))
lm.base <- lm(lower, data = na.exclude(for.reg))
lm.step <-
MASS::stepAIC(
lm.base,
scope = list(lower = lower, upper = upper),
direction = 'forward',
trace = F
)
steps <- lm.step$anova$Step
for.strgz2 <- list(lm(lower, data = na.exclude(for.reg)))
form <- lower
if (length(steps) > 1) {
for (i in 2:length(steps)) {
cmmnd <- paste('update(form, ~ . ', steps[i], ')', sep = '')
assign('form', eval(parse(text = cmmnd)))
print(form)
for.strgz2[[i]] <- lm(form, data = na.exclude(for.reg))
}
}
diag.save.lm(for.strgz2[[i]], paste(ass, '-on-', y, sep = ''), file.path(wd, 'results'))
for.strgz1[[assn]][[y]] <- for.strgz2
}
stargazer(
for.strgz1,
digits = 2,
title = assn,
df = F,
out = file.path(file.path(wd, 'results'), paste(assn, '-step-on-', y, '.html', sep = ''))
)
}
for.reg
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
rownames(raw_data) <- paste(raw_data$year, raw_data$name)
# Corrs -------------------------------------------------------------------
vars <-
c(
'rank',
'prize',
'scoring_avg',
'wins',
'plays',
'top10finish_percentile',
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for.corr <- raw_data[, ..vars]
plot.save.cor(for.corr, file.path(wd, 'results'))
# OLS ---------------------------------------------------------------------
ssnresult <- c('rank',
'prize')
perfs <- c('scoring_avg',
'wins',
'plays',
'top10finish_percentile')
techs <- c(
'name',
'year',
# for naming rows
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for (ass in list('KLPGA', 'LPGA', c('KLPGA', 'LPGA'))) {
if (length(ass) > 1) {
assn <- paste(ass, collapse = '+')
} else{
assn <- ass
}
for.strgz1 <- list()
for (y in ssnresult) {
vars <- c(techs, y)
for.reg <-
raw_data[association %in% ass, ..vars] %>% na.omit %>% as.data.table
# rownames(for.reg) <- paste(for.reg$name, for.reg$year)
for.reg[, `:=`(name = NULL, year = NULL)]
lower <- as.formula(paste(y, '~ 1', sep = ''))
linear <- paste(names(for.reg)[names(for.reg) != y], collapse = '+')
# interactions <- paste(techs[techs != y], collapse = '*')
upper <-
as.formula(paste(y, '~', linear, sep = ''))
lm.base <- lm(lower, data = na.exclude(for.reg))
lm.step <-
MASS::stepAIC(
lm.base,
scope = list(lower = lower, upper = upper),
direction = 'forward',
trace = F
)
steps <- lm.step$anova$Step
for.strgz2 <- list(lm(lower, data = na.exclude(for.reg)))
form <- lower
if (length(steps) > 1) {
for (i in 2:length(steps)) {
cmmnd <- paste('update(form, ~ . ', steps[i], ')', sep = '')
assign('form', eval(parse(text = cmmnd)))
print(form)
for.strgz2[[i]] <- lm(form, data = na.exclude(for.reg))
}
}
diag.save.lm(for.strgz2[[i]], paste(ass, '-on-', y, sep = ''), file.path(wd, 'results'))
for.strgz1[[assn]][[y]] <- for.strgz2
}
stargazer(
for.strgz1,
digits = 2,
title = assn,
df = F,
out = file.path(file.path(wd, 'results'), paste(assn, '-step-on-', y, '.html', sep = ''))
)
}
pckgs <- c('readxl', 'data.table', 'ggplot2', 'dplyr', 'stargazer')
sapply(pckgs, require, character.only = T)
raw_data <- read_excel(file.path(wd, "raw_data.xlsx")) %>% arrange(name, year)
raw_data <- data.table(raw_data)
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
rownames(raw_data) <- paste(raw_data$year, raw_data$name)
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
vars <-
c(
'rank',
'prize',
'scoring_avg',
'wins',
'plays',
'top10finish_percentile',
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for.corr <- raw_data[, ..vars]
plot.save.cor(for.corr, file.path(wd, 'results'))
ssnresult <- c('rank',
'prize')
perfs <- c('scoring_avg',
'wins',
'plays',
'top10finish_percentile')
techs <- c(
'name',
'year',
# for naming rows
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for (ass in list('KLPGA', 'LPGA', c('KLPGA', 'LPGA'))) {
if (length(ass) > 1) {
assn <- paste(ass, collapse = '+')
} else{
assn <- ass
}
for.strgz1 <- list()
for (y in ssnresult) {
vars <- c(techs, y)
for.reg <-
raw_data[association %in% ass, ..vars] %>% na.omit %>% as.data.table
# rownames(for.reg) <- paste(for.reg$name, for.reg$year)
for.reg[, `:=`(name = NULL, year = NULL)]
lower <- as.formula(paste(y, '~ 1', sep = ''))
linear <- paste(names(for.reg)[names(for.reg) != y], collapse = '+')
# interactions <- paste(techs[techs != y], collapse = '*')
upper <-
as.formula(paste(y, '~', linear, sep = ''))
lm.base <- lm(lower, data = na.exclude(for.reg))
lm.step <-
MASS::stepAIC(
lm.base,
scope = list(lower = lower, upper = upper),
direction = 'forward',
trace = F
)
steps <- lm.step$anova$Step
for.strgz2 <- list(lm(lower, data = na.exclude(for.reg)))
form <- lower
if (length(steps) > 1) {
for (i in 2:length(steps)) {
cmmnd <- paste('update(form, ~ . ', steps[i], ')', sep = '')
assign('form', eval(parse(text = cmmnd)))
print(form)
for.strgz2[[i]] <- lm(form, data = na.exclude(for.reg))
}
}
diag.save.lm(for.strgz2[[i]], paste(ass, '-on-', y, sep = ''), file.path(wd, 'results'))
for.strgz1[[assn]][[y]] <- for.strgz2
}
stargazer(
for.strgz1,
digits = 2,
title = assn,
df = F,
out = file.path(file.path(wd, 'results'), paste(assn, '-step-on-', y, '.html', sep = ''))
)
}
raw_data
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
raw_data
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data <- read_excel(file.path(wd, "raw_data.xlsx")) %>% arrange(name, year)
View(raw_data)
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
View(raw_data)
raw_data
sink()
raw_data
sink()
raw_data
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
wd <- 'GoogleDrive/Research/StatConsult/Soomgo/2005/이민수'
source(file.path(wd, 'methods.R'))
raw_data[, prize := round(prize)]
raw_data[association == 'KLPGA', prize := prize / 10 ^ 3] # 단위 = 천원
# Corrs -------------------------------------------------------------------
vars <-
c(
'rank',
'prize',
'scoring_avg',
'wins',
'plays',
'top10finish_percentile',
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for.corr <- raw_data[, ..vars]
plot.save.cor(for.corr, file.path(wd, 'results'))
# OLS ---------------------------------------------------------------------
ssnresult <- c('rank',
'prize')
perfs <- c('scoring_avg',
'wins',
'plays',
'top10finish_percentile')
techs <- c(
'name',
'year',
# for naming rows
'driving_accuracy',
'driving_distance',
'green_in_regulation',
'putting_avg',
'birdies'
)
for (ass in list('KLPGA', 'LPGA', c('KLPGA', 'LPGA'))) {
if (length(ass) > 1) {
assn <- paste(ass, collapse = '+')
} else{
assn <- ass
}
for.strgz1 <- list()
for (y in ssnresult) {
vars <- c(techs, y)
for.reg <-
raw_data[association %in% ass, ..vars] %>% na.omit %>% as.data.table
# rownames(for.reg) <- paste(for.reg$name, for.reg$year)
for.reg[, `:=`(name = NULL, year = NULL)]
lower <- as.formula(paste(y, '~ 1', sep = ''))
linear <- paste(names(for.reg)[names(for.reg) != y], collapse = '+')
# interactions <- paste(techs[techs != y], collapse = '*')
upper <-
as.formula(paste(y, '~', linear, sep = ''))
lm.base <- lm(lower, data = na.exclude(for.reg))
lm.step <-
MASS::stepAIC(
lm.base,
scope = list(lower = lower, upper = upper),
direction = 'forward',
trace = F
)
steps <- lm.step$anova$Step
for.strgz2 <- list(lm(lower, data = na.exclude(for.reg)))
form <- lower
if (length(steps) > 1) {
for (i in 2:length(steps)) {
cmmnd <- paste('update(form, ~ . ', steps[i], ')', sep = '')
assign('form', eval(parse(text = cmmnd)))
print(form)
for.strgz2[[i]] <- lm(form, data = na.exclude(for.reg))
}
}
diag.save.lm(for.strgz2[[i]], paste(ass, '-on-', y, sep = ''), file.path(wd, 'results'))
for.strgz1[[assn]][[y]] <- for.strgz2
}
stargazer(
for.strgz1,
digits = 2,
title = assn,
df = F,
out = file.path(file.path(wd, 'results'), paste(assn, '-step-on-', y, '.html', sep = ''))
)
}
raw_data
raw_data
techs
ssnresult
setwd('./GoogleDrive/Research/StatConsult/Soomgo/2005/이민수/')
